[Rainmeter]
Update=500
AccurateText=1
MouseActionCursor=0
SkinWidth=(#Width#+80)
SkinHeight=40
ContextTitle=Settings
ContextAction=["#@#variables.ini"]
ContextTitle2=---
ContextTitle3=AIMP
ContextAction3=[!WriteKeyValue Variables Player AIMP "#@#Variables.ini"][!Refresh]
ContextTitle4=Foobar
ContextAction4=[!WriteKeyValue Variables Player Foobar "#@#Variables.ini"][!Refresh]
ContextTitle5=GPMDP
ContextAction5=[!WriteKeyValue Variables Player GPMDP "#@#Variables.ini"][!Refresh]
ContextTitle6=iTunes
ContextAction6=[!WriteKeyValue Variables Player iTunes "#@#Variables.ini"][!Refresh]
ContextTitle7=MediaMonkey
ContextAction7=[!WriteKeyValue Variables Player MediaMonkey "#@#Variables.ini"][!Refresh]
ContextTitle8=MusicBee
ContextAction8=[!WriteKeyValue Variables Player MusicBee "#@#Variables.ini"][!Refresh]
ContextTitle9=Spotify
ContextAction9=[!WriteKeyValue Variables Player Spotify "#@#Variables.ini"][!Refresh]
ContextTitle10=Web
ContextAction10=[!WriteKeyValue Variables Player Web "#@#Variables.ini"][!Refresh]
ContextTitle11=Winamp
ContextAction11=[!WriteKeyValue Variables Player Winamp "#@#Variables.ini"][!Refresh]
ContextTitle12=WMP
ContextAction12=[!WriteKeyValue Variables Player WMP "#@#Variables.ini"][!Refresh]
ContextTitle13=---
ContextTitle14=Progress Bar: On
ContextAction14=[!EnableMeasure ProgressToggle][!UpdateMeasure ProgressToggle][!DisableMeasure ProgressToggle][!Refresh]
ContextTitle15=Border: On
ContextAction15=[!EnableMeasure BorderToggle][!UpdateMeasure BorderToggle][!DisableMeasure BorderToggle][!Refresh]
ContextTitle16=---
ContextTitle17=Rainmeter settings
ContextAction17=[!SkinMenu]

[Metadata]
Name=Bubble Player
Author=EskiMojo14
Version=1.0
Information=A simple player skin, designed to fit in the taskbar. | If placing in taskbar, use Stay Topmost for best results. (note that this means it'll be on top of *everything*) | Left click title or artist to play/pause music. | Right click to change player, or modify settings. To modify colour and font settings, click "Settings".

[Variables]
@includeVariables=#@#Variables.ini
@includePlayers=#@#Players/#Player#.inc

;Constants, please change via context menu
ShowProgressBar=1
ShowBorder=1


[BaseShape]
Meter=Shape
Shape=Rectangle 0,0,(#Width#+80),40,20,20 | StrokeWidth 0 | Fill Color #BackgroundColour#
RightMouseUpAction=[!SkinCustomMenu]

[ProgressBar]
Meter=Shape
Shape=Rectangle (5*#ShowBorder#), (5*#ShowBorder#),((#Width#+(80-(10*#ShowBorder#)))*([Progress]/100)),(40-(10*#ShowBorder#)), (20-(5*#ShowBorder#)), (20-(5*#ShowBorder#)) | StrokeWidth 0 | Fill Color #ButtonColour#,(255*#ShowProgressBar#)
Shape2=Rectangle 0,0,(#Width#+80),40,20,20
Shape3=Combine Shape | Intersect Shape2
DynamicVariables=1
UpdateDivider=0.1

[ProgressCalc]
Measure=Calc
Formula=#ShowProgressBar#
IfCondition=ProgressCalc=0
IfTrueAction=[!SetOption ProgressSwitch String "1"][!SetOption ProgressOnOff String "On"]
IfFalseAction=[!SetOption ProgressSwitch String "0"][!SetOption ProgressOnOff String "Off"]

[ProgressSwitch]
Measure=String
String=0

[ProgressOnOff]
Measure=String
String=On

[ProgressToggle]
Measure=String
String=Progress
IfMatch=Progress
IfMatchAction=[!WriteKeyValue Variables ShowProgressBar [ProgressSwitch]][!WriteKeyValue Rainmeter ContextTitle14 "Progress Bar: [ProgressOnOff]"]
Disabled=1

[Border]
Meter=Shape
Shape=Rectangle 0,0,(#Width#+80),40,20,20 | StrokeWidth 0 | Fill Color #BorderColour#,(255*#ShowBorder#)
Shape2=Rectangle 5,5,(#Width#+70),30,15,15
Shape3=Ellipse 20,20,20
Shape4=Ellipse (#Width#+60),20,20
Shape5=Combine Shape | XOR Shape2 | Union Shape3 | Union Shape4

[BorderCalc]
Measure=Calc
Formula=#ShowBorder#
IfCondition=BorderCalc=0
IfTrueAction=[!SetOption BorderSwitch String "1"][!SetOption BorderOnOff String "On"]
IfFalseAction=[!SetOption BorderSwitch String "0"][!SetOption BorderOnOff String "Off"]

[BorderSwitch]
Measure=String
String=0

[BorderOnOff]
Measure=String
String=On

[BorderToggle]
Measure=String
String=Border
IfMatch=Border
IfMatchAction=[!WriteKeyValue Variables ShowBorder [BorderSwitch]][!WriteKeyValue Rainmeter ContextTitle15 "Border: [BorderOnOff]"]
Disabled=1

[ButtonStyle]
MouseOverAction=[!SetOption #CURRENTSECTION# Overlay "Fill Color 255,255,255,64"][!Update]
MouseLeaveAction=[!SetOption #CURRENTSECTION# Overlay "Fill Color 255,255,255,0"][!Update]
Overlay=Fill Color 255,255,255,0

[Previous]
Meter=Shape
Shape=Ellipse 20,20,15 | StrokeWidth 0 | Fill Color #ButtonColour#
Shape2=Ellipse 20,20,15 | StrokeWidth 0 | Extend Overlay
Shape3=Path Path1 | StrokeWidth 0 | Fill Color #MainColour# | Offset (-10/6),0
Path1=10,20 | LineTo 20,15 | LineTo 20,20 | LineTo 30,15 | LineTo 30,25 | LineTo 20,20 | LineTo 20,25
MeterStyle=ButtonStyle
LeftMouseUpAction=[!CommandMeasure Player Previous]

[Next]
Meter=Shape
Shape=Ellipse (#Width#+60),20,15 | StrokeWidth 0 | Fill Color #ButtonColour#
Shape2=Ellipse (#Width#+60),20,15 | StrokeWidth 0 | Extend Overlay
Shape3=Path Path1 | StrokeWidth 0 | Fill Color #MainColour# | Offset (10/6),0
Path1=(#Width#+70),20 | LineTo (#Width#+60),15 | LineTo (#Width#+60),20 | LineTo (#Width#+50),15 | LineTo (#Width#+50),25 | LineTo (#Width#+60),20 | LineTo (#Width#+60),25
MeterStyle=ButtonStyle
LeftMouseUpAction=[!CommandMeasure Player Next]

;=====================================================;
;------------------------TRACK------------------------;
;=====================================================;

[TrackHitbox]
Meter=String
MeasureName=Track
InlineSetting=Color | 0,0,0,0
InlineSetting2=Face | #Font#
InlineSetting3=Size | #TrackSize#
InlineSetting4=Weight | 700
Y=10
X=45
AntiAlias=1
ClipString=2
StringAlign=LeftCenter
SolidColor=#MainColour#,1
ClipStringW=(#Width#-10)
ClipStringH=20
Padding=0,(5*#ShowBorder#),0,0
MouseOverAction=[!CommandMeasure ScrollTextScript "timing=timing==0 and 1 or timing"][!CommandMeasure MusicTextScrollActionTimer "Stop 1"][!CommandMeasure MusicTextScrollActionTimer "Execute 1"][!SetOption MeterTrack InlineSetting5 "Underline"][!Update]
MouseLeaveAction=[!SetOption MeterTrack InlineSetting5 ""][!Update]
LeftMouseUpAction=[!CommandMeasure Player PlayPause]
UpdateDivider=0.1

[MeterTrack]
Meter=String
InlineSetting=None
InlineSetting2=Face | #Font#
InlineSetting3=Size | #TrackSize#
InlineSetting4=Weight | 700
Y=10
AntiAlias=1
StringAlign=LeftCenter
Padding=0,(5*#ShowBorder#),0,0

[MeterTrackRepeat]
Meter=String
MeterStyle=MeterTrack
X=30R

[ScrollTextScript]
Measure=Script
ScriptFile=#@#Scripts\ScrollText.lua
Text=[Track]
Fade=20
Color=#MainColour#
Width=(#Width#-10)
Speed=1.25
AnchorX=45
MeterName=MeterTrack
RepeatGap=30
ActionTimer=MusicTextScrollActionTimer
DynamicVariables=1

[MusicTextScrollActionTimer]
Measure=Plugin
Plugin=ActionTimer
ActionList1=Repeat Scroll,33,10000
Scroll = [!CommandMeasure ScrollTextScript "UpdateNow()"][!Redraw]

;======================================================;
;------------------------ARTIST------------------------;
;======================================================;

[ArtistHitbox]
Meter=String
MeasureName=Artist
InlineSetting=Color | 0,0,0,0
InlineSetting2=Face | #Font#
InlineSetting3=Size | #ArtistSize#
InlineSetting4=Weight | 400
Y=30
X=45
AntiAlias=1
ClipString=2
StringAlign=LeftCenter
SolidColor=#MainColour#,1
ClipStringW=(#Width#-10)
ClipStringH=20
Padding=0,0,0,(5*#ShowBorder#)
MouseOverAction=[!CommandMeasure ScrollTextScriptArtist "timing=timing==0 and 1 or timing"][!CommandMeasure MusicTextScrollActionTimerArtist "Stop 1"][!CommandMeasure MusicTextScrollActionTimerArtist "Execute 1"][!SetOption MeterArtist InlineSetting5 "Underline"]
MouseLeaveAction=[!SetOption MeterArtist InlineSetting5 ""]
LeftMouseUpAction=[!CommandMeasure Player PlayPause]

[MeterArtist]
Meter=String
InlineSetting=None
InlineSetting2=Face | #Font#
InlineSetting3=Size | #ArtistSize#
InlineSetting4=Weight | 400
Y=30
AntiAlias=1
StringAlign=LeftCenter
Padding=0,0,0,(5*#ShowBorder#)

[MeterArtistRepeat]
Meter=String
MeterStyle=MeterArtist
X=30R

[ScrollTextScriptArtist]
Measure=Script
ScriptFile=#@#Scripts\ScrollText.lua
Text=[Artist]
Fade=20
Color=#MainColour#
Width=(#Width#-10)
Speed=1.25
AnchorX=45
MeterName=MeterArtist
RepeatGap=30
ActionTimer=MusicTextScrollActionTimerArtist
DynamicVariables=1

[MusicTextScrollActionTimerArtist]
Measure=Plugin
Plugin=ActionTimer
ActionList1=Repeat Scroll,33,10000
Scroll = [!CommandMeasure ScrollTextScriptArtist "UpdateNow()"][!Redraw]
